<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue3 - Reactive vs Ref å¯¹æ¯”å­¦ä¹ </title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 2em;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            background: #f9f9f9;
        }
        .card.ref {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
        }
        .card.reactive {
            border-color: #f093fb;
            background: linear-gradient(135deg, #f093fb10 0%, #f5576c10 100%);
        }
        h2 {
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .badge {
            font-size: 0.6em;
            padding: 4px 8px;
            border-radius: 20px;
            background: #333;
            color: white;
        }
        .input-group {
            margin: 15px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
            margin: 5px;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .output {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #e0e0e0;
        }
        .output h3 {
            color: #666;
            margin-bottom: 10px;
            font-size: 1em;
        }
        .output pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 13px;
        }
        .tips {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        .tips h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        .tips ul {
            margin-left: 20px;
            color: #856404;
        }
        .tips li {
            margin: 5px 0;
        }
        .code-snippet {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <h1>ğŸ¯ Reactive vs Ref æ·±åº¦å¯¹æ¯”</h1>
            
            <div class="comparison">
                <!-- Ref ç¤ºä¾‹ -->
                <div class="card ref">
                    <h2>
                        ğŸ“¦ Ref 
                        <span class="badge">æ¨è</span>
                    </h2>
                    
                    <div class="input-group">
                        <label>åŸºæœ¬ç±»å‹æ•°æ®ï¼š</label>
                        <input v-model="refString" placeholder="è¾“å…¥æ–‡æœ¬">
                        <small>å½“å‰å€¼: {{ refString }}</small>
                    </div>
                    
                    <div class="input-group">
                        <label>æ•°å­—ï¼š</label>
                        <input v-model.number="refNumber" type="number" placeholder="è¾“å…¥æ•°å­—">
                        <small>å½“å‰å€¼: {{ refNumber }}</small>
                    </div>
                    
                    <div class="input-group">
                        <label>å¯¹è±¡ç±»å‹ï¼ˆrefä¹Ÿèƒ½å¤„ç†ï¼‰ï¼š</label>
                        <input v-model="refUser.name" placeholder="å§“å">
                        <input v-model.number="refUser.age" type="number" placeholder="å¹´é¾„" style="margin-top: 5px">
                    </div>
                    
                    <button @click="updateRefData">æ›´æ–°Refæ•°æ®</button>
                    
                    <div class="output">
                        <h3>æ•°æ®ç»“æ„ï¼š</h3>
                        <pre>{{ refDataStructure }}</pre>
                    </div>
                </div>
                
                <!-- Reactive ç¤ºä¾‹ -->
                <div class="card reactive">
                    <h2>
                        ğŸ¨ Reactive
                        <span class="badge" style="background: #f093fb;">å¯¹è±¡ä¸“ç”¨</span>
                    </h2>
                    
                    <div class="input-group">
                        <label>ç”¨æˆ·ä¿¡æ¯ï¼ˆå¿…é¡»æ˜¯å¯¹è±¡ï¼‰ï¼š</label>
                        <input v-model="reactiveUser.name" placeholder="å§“å">
                        <input v-model.number="reactiveUser.age" type="number" placeholder="å¹´é¾„" style="margin-top: 5px">
                        <select v-model="reactiveUser.role" style="margin-top: 5px">
                            <option value="">é€‰æ‹©è§’è‰²</option>
                            <option value="admin">ç®¡ç†å‘˜</option>
                            <option value="user">ç”¨æˆ·</option>
                            <option value="guest">è®¿å®¢</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label>åµŒå¥—å¯¹è±¡ï¼š</label>
                        <input v-model="reactiveUser.address.city" placeholder="åŸå¸‚">
                        <input v-model="reactiveUser.address.street" placeholder="è¡—é“" style="margin-top: 5px">
                    </div>
                    
                    <button @click="updateReactiveData">æ›´æ–°Reactiveæ•°æ®</button>
                    
                    <div class="output">
                        <h3>æ•°æ®ç»“æ„ï¼š</h3>
                        <pre>{{ reactiveDataStructure }}</pre>
                    </div>
                </div>
            </div>
            
            <!-- Deep Watch ç¤ºä¾‹ -->
            <div class="card" style="grid-column: 1 / -1;">
                <h2>ğŸ‘ï¸ Watch æ·±åº¦ç›‘å¬å¯¹æ¯” {{userName}}</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h3 style="color: #667eea;">Refå¯¹è±¡çš„Watchè®°å½•ï¼š</h3>
                        <div class="code-snippet">{{ refWatchLog || 'ä¿®æ”¹ä¸Šæ–¹refå¯¹è±¡æŸ¥çœ‹ç›‘å¬æ—¥å¿—' }}</div>
                    </div>
                    <div>
                        <h3 style="color: #f093fb;">Reactiveå¯¹è±¡çš„Watchè®°å½•ï¼š</h3>
                        <div class="code-snippet">{{ reactiveWatchLog || 'ä¿®æ”¹ä¸Šæ–¹reactiveå¯¹è±¡æŸ¥çœ‹ç›‘å¬æ—¥å¿—' }}</div>
                    </div>
                </div>
            </div>
            
            <!-- TODO(human): åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå±•ç¤ºtoRefsçš„ä½¿ç”¨åœºæ™¯ -->
            <div class="card" style="grid-column: 1 / -1; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <h2>ğŸ”„ toRefs è§£æ„ä¿æŒå“åº”æ€§</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h3 style="color: #333;">âœ… ä½¿ç”¨ toRefsï¼ˆä¿æŒå“åº”æ€§ï¼‰</h3>
                        <div class="input-group">
                            <label>è§£æ„åçš„å§“åï¼ˆå“åº”å¼ï¼‰ï¼š</label>
                            <input v-model="userName" placeholder="ä¿®æ”¹å§“å">
                            <small>å½“å‰å€¼: {{ userName }}</small>
                        </div>
                        <div class="input-group">
                            <label>è§£æ„åçš„å¹´é¾„ï¼ˆå“åº”å¼ï¼‰ï¼š</label>
                            <input v-model.number="userAge" type="number" placeholder="ä¿®æ”¹å¹´é¾„">
                            <small>å½“å‰å€¼: {{ userAge }}</small>
                        </div>
                        <div class="input-group">
                            <label>è§£æ„åçš„è§’è‰²ï¼ˆå“åº”å¼ï¼‰ï¼š</label>
                            <select v-model="userRole">
                                <option value="admin">ç®¡ç†å‘˜</option>
                                <option value="user">ç”¨æˆ·</option>
                                <option value="guest">è®¿å®¢</option>
                            </select>
                            <small>å½“å‰å€¼: {{ userRole }}</small>
                        </div>
                        <div class="code-snippet" style="margin-top: 10px;">
// âœ… æ­£ç¡®æ–¹å¼ï¼šä½¿ç”¨ toRefs
const { name: userName, age: userAge, role: userRole } = toRefs(reactiveUser)
// è§£æ„åçš„å±æ€§ä»ç„¶æ˜¯å“åº”å¼çš„
// ä¿®æ”¹ä¼šåŒæ­¥åˆ°åŸå¯¹è±¡
                        </div>
                    </div>
                    
                    <div>
                        <h3 style="color: #333;">âŒ ç›´æ¥è§£æ„ï¼ˆå¤±å»å“åº”æ€§ï¼‰</h3>
                        <div class="input-group">
                            <label>æ™®é€šè§£æ„çš„å§“åï¼ˆéå“åº”å¼ï¼‰ï¼š</label>
                            <input v-model="destructuredName" placeholder="ä¿®æ”¹æ— æ•ˆ">
                            <small style="color: red;">å€¼ä¸ä¼šæ›´æ–°: {{ destructuredName }}</small>
                        </div>
                        <div class="input-group">
                            <label>æ™®é€šè§£æ„çš„å¹´é¾„ï¼ˆéå“åº”å¼ï¼‰ï¼š</label>
                            <input v-model.number="destructuredAge" type="number" placeholder="ä¿®æ”¹æ— æ•ˆ">
                            <small style="color: red;">å€¼ä¸ä¼šæ›´æ–°: {{ destructuredAge }}</small>
                        </div>
                        <div class="code-snippet" style="margin-top: 10px;">
// âŒ é”™è¯¯æ–¹å¼ï¼šç›´æ¥è§£æ„
const { name: destructuredName, age: destructuredAge } = reactiveUser
// è§£æ„åå¤±å»å“åº”æ€§ï¼
// åªæ˜¯æ™®é€šå˜é‡ï¼Œä¸ä¼šå“åº”å˜åŒ–
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px;">
                    <h3>ğŸ” åŸå§‹ reactive å¯¹è±¡ï¼ˆæ‰€æœ‰è§£æ„éƒ½ä¼šåŒæ­¥åˆ°è¿™é‡Œï¼‰ï¼š</h3>
                    <pre style="background: #f4f4f4; padding: 10px; border-radius: 4px;">{{ reactiveDataStructure }}</pre>
                    <p style="color: #666; margin-top: 10px;">
                        ğŸ’¡ æ³¨æ„ï¼šé€šè¿‡ toRefs è§£æ„çš„å±æ€§ä¿®æ”¹ä¼šåŒæ­¥åˆ°åŸå§‹ reactive å¯¹è±¡ï¼Œè€Œç›´æ¥è§£æ„çš„ä¸ä¼šã€‚
                    </p>
                </div>
            </div>
       
         
            
            <div class="tips">
                <h3>ğŸ’¡ ä½¿ç”¨å»ºè®®</h3>
                <ul>
                    <li><strong>ä¼˜å…ˆä½¿ç”¨ ref()ï¼š</strong>é€‚ç”¨äºæ‰€æœ‰ç±»å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹å’Œå¯¹è±¡</li>
                    <li><strong>ref è®¿é—®éœ€è¦ .valueï¼š</strong>åœ¨ JavaScript ä¸­è®¿é—®å’Œä¿®æ”¹éœ€è¦ .valueï¼Œæ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ…</li>
                    <li><strong>reactive ä»…ç”¨äºå¯¹è±¡ï¼š</strong>ä¸èƒ½å¤„ç†åŸºæœ¬ç±»å‹ï¼Œä½†è®¿é—®ä¸éœ€è¦ .value</li>
                    <li><strong>æ·±åº¦å“åº”ï¼š</strong>ä¸¤è€…éƒ½æ”¯æŒæ·±åº¦å“åº”å¼ï¼ŒåµŒå¥—å¯¹è±¡çš„å±æ€§å˜åŒ–éƒ½èƒ½è¢«è¿½è¸ª</li>
                    <li><strong>è§£æ„é—®é¢˜ï¼š</strong>reactive å¯¹è±¡è§£æ„åä¼šå¤±å»å“åº”æ€§ï¼Œéœ€è¦ä½¿ç”¨ toRefs</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        const { createApp, ref, reactive, computed, watch, toRefs } = Vue;
        
        createApp({
            setup() {
                // ========== Ref ç¤ºä¾‹ ==========
                const refString = ref('Hello Vue3');
                const refNumber = ref(42);
                const refUser = ref({
                    name: 'å¼ ä¸‰',
                    age: 25
                });
                const refWatchLog = ref('');
                
                // ========== Reactive ç¤ºä¾‹ ==========
                const reactiveUser = reactive({
                    name: 'æå››',
                    age: 30,
                    role: 'user',
                    address: {
                        city: 'åŒ—äº¬',
                        street: 'é•¿å®‰è¡—'
                    }
                });
                const reactiveWatchLog = ref('');
                
                // toRefs è§£æ„ç¤ºä¾‹ - æ³¨æ„å±æ€§åè¦åŒ¹é…
                const { name: userName, age: userAge, role: userRole } = toRefs(reactiveUser);
                
                // é”™è¯¯ç¤ºä¾‹ï¼šç›´æ¥è§£æ„ä¼šå¤±å»å“åº”æ€§
                let { name: destructuredName, age: destructuredAge } = reactiveUser;
                
                // ========== è®¡ç®—å±æ€§å±•ç¤ºæ•°æ®ç»“æ„ ==========
                const refDataStructure = computed(() => {
                    return JSON.stringify({
                        string: refString.value,
                        number: refNumber.value,
                        user: refUser.value
                    }, null, 2);
                });
                
                const reactiveDataStructure = computed(() => {
                    return JSON.stringify(reactiveUser, null, 2);
                });
                
                // ========== æ–¹æ³• ==========
                const updateRefData = () => {
                    refString.value = 'æ›´æ–°æ—¶é—´: ' + new Date().toLocaleTimeString();
                    refNumber.value = Math.floor(Math.random() * 100);
                    refUser.value.age++;
                };
                
                const updateReactiveData = () => {
                    reactiveUser.name = 'ç”¨æˆ·' + Math.floor(Math.random() * 100);
                    reactiveUser.age = Math.floor(Math.random() * 50) + 20;
                    reactiveUser.address.city = ['ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³'][Math.floor(Math.random() * 3)];
                };
                
                // ========== Watch ç›‘å¬ ==========
                watch(refUser, (newVal, oldVal) => {
                    refWatchLog.value = `[${new Date().toLocaleTimeString()}] 
Refå¯¹è±¡å˜åŒ–ï¼š
æ—§å€¼ï¼š${JSON.stringify(oldVal)}
æ–°å€¼ï¼š${JSON.stringify(newVal)}`;
                }, { deep: true });
                
                watch(reactiveUser, (newVal, oldVal) => {
                    reactiveWatchLog.value = `[${new Date().toLocaleTimeString()}]
Reactiveå¯¹è±¡å˜åŒ–ï¼š
æ—§å€¼ï¼š${JSON.stringify(oldVal)}
æ–°å€¼ï¼š${JSON.stringify(newVal)}`;
                }, { deep: true });
                
                return {
                    // Ref ç›¸å…³
                    refString,
                    refNumber,
                    refUser,
                    refDataStructure,
                    refWatchLog,
                    updateRefData,
                    
                    // Reactive ç›¸å…³
                    reactiveUser,
                    reactiveDataStructure,
                    reactiveWatchLog,
                    updateReactiveData,
                    
                    // toRefs ç›¸å…³
                    userName,
                    userAge,
                    userRole,
                    destructuredName,
                    destructuredAge
                };
            }
        }).mount('#app');
    </script>
</body>
</html>